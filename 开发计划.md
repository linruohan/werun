# Vicinae-like 启动器开发计划

## 项目概述

使用 **Rust + GPUI + gpui-component** 开发一个高性能 Windows 启动器，灵感来源于 Vicinae，具有现代化的 UI 和流畅的动画效果。

---

## 技术栈

- **框架**: GPUI (Zed 编辑器团队开发的 GPU 加速 UI 框架)
- **组件库**: gpui-component (丰富的 UI 组件库)
- **语言**: Rust (C++26 级别的现代系统编程)
- **平台**: Windows 10/11

---

## 项目结构

```
werun/
├── Cargo.toml                 # 项目配置
├── src/
│   ├── main.rs               # 入口点
│   ├── app.rs                # 应用主逻辑
│   ├── lib.rs                # 库导出
│   ├── core/                 # 核心模块
│   │   ├── mod.rs
│   │   ├── search.rs         # 搜索引擎
│   │   ├── plugin.rs         # 插件系统接口
│   │   └── config.rs         # 配置管理
│   ├── ui/                   # UI 组件
│   │   ├── mod.rs
│   │   ├── launcher_window.rs    # 主窗口
│   │   ├── search_bar.rs         # 搜索栏
│   │   ├── result_list.rs        # 结果列表
│   │   ├── result_item.rs        # 结果项
│   │   └── preview_panel.rs      # 预览面板
│   ├── plugins/              # 内置插件
│   │   ├── mod.rs
│   │   ├── app_launcher.rs   # 应用启动
│   │   ├── file_search.rs    # 文件搜索
│   │   ├── calculator.rs     # 计算器
│   │   └── clipboard.rs      # 剪贴板历史
│   ├── platform/             # 平台相关
│   │   ├── mod.rs
│   │   └── windows.rs        # Windows API 封装
│   └── utils/
│       ├── mod.rs
│       ├── fuzzy.rs          # 模糊搜索
│       └── icons.rs          # 图标加载
├── assets/                   # 静态资源
│   ├── icons/
│   └── themes/
└── config/                   # 默认配置
    └── default.json
```

---

## 核心依赖

```toml
[dependencies]
# GPUI 核心框架
gpui = { git = "https://github.com/zed-industries/zed" }
gpui-component = { git = "https://github.com/longbridge/gpui-component" }

# Windows API
windows = { version = "0.52", features = [
    "Win32_System_Threading",
    "Win32_UI_Shell",
    "Win32_UI_WindowsAndMessaging",
    "Win32_System_Com",
    "Win32_Storage_FileSystem",
] }

# 异步运行时
tokio = { version = "1.35", features = ["full"] }

# 序列化
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"

# 配置管理
config = "0.14"

# 模糊搜索
nucleo = "0.5"

# 剪贴板
clipboard-rs = "0.1"

# 图标提取
ico = "0.3"
image = "0.24"

# 其他工具
anyhow = "1.0"
parking_lot = "0.12"
dashmap = "5.5"
once_cell = "1.19"
```

---

## 开发阶段

### Phase 1: 项目初始化与基础架构 (Day 1-2)

#### 1.1 创建项目
- [ ] 初始化 Rust 项目
- [ ] 配置 Cargo.toml 依赖
- [ ] 设置项目结构

#### 1.2 基础窗口
- [ ] 创建无边框浮动窗口
- [ ] 实现窗口居中显示
- [ ] 添加圆角和阴影效果
- [ ] 实现失焦自动隐藏

#### 1.3 配置系统
- [ ] 配置文件读取/保存
- [ ] 默认配置生成
- [ ] 配置热重载

---

### Phase 2: 核心搜索界面 (Day 3-5)

#### 2.1 搜索栏组件
- [ ] 搜索输入框 (Input 组件)
- [ ] 搜索图标前缀
- [ ] 占位符文本
- [ ] 输入事件处理

#### 2.2 结果列表
- [ ] List 组件集成
- [ ] 结果项渲染
- [ ] 分组显示 (应用/文件/命令)
- [ ] 图标显示

#### 2.3 键盘导航
- [ ] ↑↓ 选择导航
- [ ] ↵ 确认执行
- [ ] Esc 关闭窗口
- [ ] 快捷键绑定

#### 2.4 预览面板
- [ ] 右侧详情面板
- [ ] 文件预览
- [ ] 应用信息展示

---

### Phase 3: 插件系统 (Day 6-10)

#### 3.1 插件架构
- [ ] Plugin trait 定义
- [ ] 插件注册机制
- [ ] 插件优先级管理
- [ ] 异步搜索支持

#### 3.2 应用启动插件
- [ ] 扫描开始菜单
- [ ] 解析 .lnk 快捷方式
- [ ] 提取应用图标
- [ ] 应用索引缓存

#### 3.3 文件搜索插件
- [ ] 文件索引建立
- [ ] 快速搜索实现
- [ ] 文件类型识别
- [ ] 文件预览支持

#### 3.4 计算器插件
- [ ] 数学表达式解析
- [ ] 实时计算结果
- [ ] 计算历史记录

#### 3.5 剪贴板历史插件
- [ ] 剪贴板监听
- [ ] 历史记录存储
- [ ] 文本/图片支持
- [ ] 快速粘贴

---

### Phase 4: Windows 平台集成 (Day 11-13)

#### 4.1 全局快捷键
- [ ] Alt+Space 注册
- [ ] 快捷键冲突处理
- [ ] 系统托盘图标

#### 4.2 窗口管理
- [ ] 置顶显示
- [ ] 多显示器支持
- [ ] DPI 适配
- [ ] 高分屏支持

#### 4.3 系统集成
- [ ] 开机自启
- [ ] 安装/卸载程序
- [ ] UAC 权限处理

---

### Phase 5: 主题与优化 (Day 14-17)

#### 5.1 主题系统
- [ ] 主题配置结构
- [ ] 内置主题 (Dark/Light)
- [ ] 自定义主题支持
- [ ] 动态主题切换

#### 5.2 动画效果
- [ ] 窗口显示/隐藏动画
- [ ] 列表滚动动画
- [ ] 选中项过渡效果
- [ ] 加载动画

#### 5.3 性能优化
- [ ] 搜索延迟优化
- [ ] 内存使用优化
- [ ] 索引增量更新
- [ ] 后台线程管理

---

### Phase 6: 测试与发布 (Day 18-20)

#### 6.1 功能测试
- [ ] 单元测试
- [ ] 集成测试
- [ ] 性能测试

#### 6.2 Windows 适配
- [ ] Windows 10 测试
- [ ] Windows 11 测试
- [ ] 不同 DPI 测试

#### 6.3 打包发布
- [ ] 单文件打包
- [ ] 安装程序制作
- [ ] 自动更新支持

---

## UI 设计规范

### 窗口尺寸
- 默认宽度: 800px
- 默认高度: 500px
- 最小宽度: 600px
- 圆角半径: 12px

### 配色方案 (Dark)
```
背景: #1e1e2e
前景: #cdd6f4
强调色: #89b4fa
边框: #313244
选中: #45475a
```

### 配色方案 (Light)
```
背景: #eff1f5
前景: #4c4f69
强调色: #1e66f5
边框: #ccd0da
选中: #dce0e8
```

### 字体
- 主字体: Inter, Segoe UI
- 等宽字体: JetBrains Mono, Consolas
- 基础字号: 14px

---

## 功能清单

### MVP 功能 (必须实现)
- [ ] 应用启动
- [ ] 文件搜索
- [ ] 计算器
- [ ] 剪贴板历史
- [ ] 主题切换
- [ ] 全局快捷键

### 进阶功能 (后续迭代)
- [ ] 自定义脚本命令
- [ ] 扩展插件系统
- [ ] 系统命令 (关机/重启)
- [ ] 颜色选择器
- [ ] 窗口切换
- [ ] 浏览器书签搜索

---

## 参考资源

- [GPUI 文档](https://www.gpui.rs/)
- [gpui-component 文档](https://longbridge.github.io/gpui-component/)
- [Vicinae GitHub](https://github.com/vicinaehq/vicinae)
- [Windows API 文档](https://docs.microsoft.com/en-us/windows/win32/api/)

---

## 开发里程碑

| 阶段 | 时间 | 目标 |
|------|------|------|
| Phase 1 | Day 1-2 | 基础窗口运行 |
| Phase 2 | Day 3-5 | 搜索界面完成 |
| Phase 3 | Day 6-10 | 核心插件实现 |
| Phase 4 | Day 11-13 | Windows 集成 |
| Phase 5 | Day 14-17 | 美化与优化 |
| Phase 6 | Day 18-20 | 测试发布 |

---

*计划制定时间: 2026-02-15*
*预计完成时间: 20 天*
